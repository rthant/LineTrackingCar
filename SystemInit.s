MCG_C1	EQU	0x40064000 
MCG_C2	EQU	0x40064001 
MCG_C3	EQU	0x40064002 
MCG_C4	EQU	0x40064003 
MCG_C5	EQU	0x40064004 
MCG_C6	EQU	0x40064005 
MCG_S	EQU	0x40064006 
MCG_SC	EQU	0x40064008 
MCG_ATCVH	EQU	0x4006400A 
MCG_ATCVL	EQU	0x4006400B 
MCG_C7	EQU	0x4006400C 
MCG_C8	EQU	0x4006400D 
MCG_C9	EQU	0x4006400E 
MCG_C10	EQU	0x4006400F 

	AREA SytemInit_area, CODE, READONLY
	EXPORT SystemInit

SystemInit

; MCG_C2 = 0x14
	LDR	R0,=MCG_C2
	MOVS R1,#0x14
	STR R1,[R0]

; MCG_C1 = 0x98
	LDR	R0,=MCG_C1
	MOVS R1,#0x98
	STR R1,[R0]

	LDR	R0,=MCG_S
; Wait for MCG_S.OSCINIT0 (bit 2) = 1
	MOVS R2,#0x02
wait_oscinit0
	LDRB R1,[R0]
	ANDS R1,R2
	BNE	wait_oscinit0
	
; Wait for MCG_S.IREFST (bit 4) = 0
	MOVS R2,#0x10
wait_irefst
	LDRB R1,[R0]
	ANDS R1,R2
	BEQ	wait_irefst
	
; Wait for MCG_S.CLKST (bits 3-2) = 2
	MOVS R2,#0x0C
wait_clkst
	LDRB R1,[R0]
	ANDS R1,R2
	CMP	R1,#0x04
	BNE	wait_clkst
	
	BX LR
	
	END